<!DOCTYPE html>
<html>
<head>
<title>Ambedkar Institute Appointment System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:Arial;}
body{
    min-height:100vh;
    background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    display:flex;justify-content:center;align-items:center;
}
.card{
    width:350px;padding:40px;
    background:rgba(255,255,255,0.1);
    backdrop-filter:blur(10px);
    border-radius:15px;
    box-shadow:0 0 25px rgba(0,0,0,0.5);
    text-align:center;color:white;
}
input, select{
    width:100%;padding:12px;margin:10px 0;
    border:none;border-radius:8px;
    background:rgba(255,255,255,0.2);color:white;
}
button{
    width:100%;padding:10px;margin-top:8px;
    border:none;border-radius:8px;
    color:white;cursor:pointer;
}
.book-btn{background:linear-gradient(90deg,#00c6ff,#0072ff);}
.logout-btn{background:red;}
.edit-btn{background:orange;width:auto;padding:6px 12px;margin-right:5px;}
.delete-btn{background:crimson;width:auto;padding:6px 12px;}
#appointmentPage{
    display:none;width:95%;max-width:900px;
    background:white;border-radius:10px;padding:20px;
}
.header{
    background:#0d47a1;color:white;
    padding:15px;text-align:center;
    border-radius:10px 10px 0 0;
}
.form-section{padding:20px;}
.form-section input,.form-section select{
    background:#f1f1f1;color:black;
}
</style>
</head>

<body>

<div class="card" id="authBox">
    <h2 id="formTitle">Login</h2>
    <input type="text" id="username" placeholder="Username">
    <input type="password" id="password" placeholder="Password">
    <button class="book-btn" id="mainBtn" onclick="handleAuth()">Login</button>
    <p style="margin-top:10px;cursor:pointer;" onclick="toggleForm()">Toggle Login/Signup</p>
</div>

<div id="appointmentPage">
    <div class="header">
        <h1>Ambedkar Institute of Higher Education</h1>
        <p>Appointments Booking Dashboard</p>
    </div>

    <div class="form-section">
        <h3>Book Appointment</h3>

        <input type="text" id="studentName" placeholder="Student Name">
        <input type="text" id="studentAddress" placeholder="Student Address">
        <input type="email" id="email" placeholder="Email">
        <input type="date" id="date">
        <input type="time" id="time">

        <select id="department">
            <option value="">Select Department</option>
            <option>Admission</option>
            <option>Accounts</option>
            <option>Examination</option>
            <option>Faculty</option>
        </select>

        <button class="book-btn" onclick="saveAppointment()" id="saveBtn">
            Book Appointment
        </button>

        <button class="logout-btn" onclick="logout()">Logout</button>
        <button class="book-btn" onclick="showAppointments()">Appointment List</button>

        <div id="appointmentList" style="margin-top:20px;"></div>
    </div>
</div>

<script>

let isLogin = true;
let editIndex = -1;

function toggleForm(){
    isLogin = !isLogin;
    formTitle.innerText = isLogin ? "Login" : "Signup";
    mainBtn.innerText = isLogin ? "Login" : "Signup";
}

function handleAuth(){
    let user=username.value.trim();
    let pass=password.value.trim();

    if(user===""||pass===""){alert("Fill all fields");return;}

    if(!isLogin){
        if(localStorage.getItem(user)){alert("User exists");return;}
        localStorage.setItem(user,pass);
        alert("Signup Successful");
        toggleForm();
        return;
    }

    if(localStorage.getItem(user)===pass){
        localStorage.setItem("loggedInUser",user);
        showAppointment();
    }else alert("Invalid Login");
}

function showAppointment(){
    authBox.style.display="none";
    appointmentPage.style.display="block";
    welcomeUser.innerText="Welcome, "+localStorage.getItem("loggedInUser");
}

function saveAppointment(){

    let name=studentName.value.trim();
    let address=studentAddress.value.trim();
    let mail=email.value.trim();
    let dateVal=date.value;
    let timeVal=time.value;
    let dept=department.value;

    if(name===""||address===""||mail===""||dateVal===""||timeVal===""||dept===""){
        alert("Fill all details");return;
    }

    let user=localStorage.getItem("loggedInUser");
    let appointments=JSON.parse(localStorage.getItem(user+"_appointments"))||[];

    let appointment={name,address,mail,dateVal,timeVal,dept};

    if(editIndex===-1){
        appointments.push(appointment);
    }else{
        appointments[editIndex]=appointment;
        editIndex=-1;
        saveBtn.innerText="Book Appointment";
    }

    localStorage.setItem(user+"_appointments",JSON.stringify(appointments));
    clearForm();
    showAppointments();
}

function showAppointments(){
    let user=localStorage.getItem("loggedInUser");
    let appointments=JSON.parse(localStorage.getItem(user+"_appointments"))||[];
    appointmentList.innerHTML="";

    if(appointments.length===0){
        appointmentList.innerHTML="<p>No appointments found</p>";
        return;
    }

    appointments.forEach((a,index)=>{
        appointmentList.innerHTML+=`
        <div style="border:1px solid #ccc;padding:10px;margin:10px 0;border-radius:5px;">
            <b>Appointment ${index+1}</b><br>
            Name: ${a.name}<br>
            Address: ${a.address}<br>
            Email: ${a.mail}<br>
            Date: ${a.dateVal}<br>
            Time: ${a.timeVal}<br>
            Department: ${a.dept}<br><br>
            <button class="edit-btn" onclick="editAppointment(${index})">Edit</button>
            <button class="delete-btn" onclick="deleteAppointment(${index})">Delete</button>
        </div>`;
    });
}

function editAppointment(index){
    let user=localStorage.getItem("loggedInUser");
    let appointments=JSON.parse(localStorage.getItem(user+"_appointments"))||[];
    let a=appointments[index];

    studentName.value=a.name;
    studentAddress.value=a.address;
    email.value=a.mail;
    date.value=a.dateVal;
    time.value=a.timeVal;
    department.value=a.dept;

    editIndex=index;
    saveBtn.innerText="Update Appointment";
    window.scrollTo(0,0);
}

function deleteAppointment(index){
    if(confirm("Are you sure you want to delete this appointment?")){
        let user=localStorage.getItem("loggedInUser");
        let appointments=JSON.parse(localStorage.getItem(user+"_appointments"))||[];
        appointments.splice(index,1);
        localStorage.setItem(user+"_appointments",JSON.stringify(appointments));
        showAppointments();
    }
}

function clearForm(){
    studentName.value="";
    studentAddress.value="";
    email.value="";
    date.value="";
    time.value="";
    department.selectedIndex=0;
}

function logout(){
    localStorage.removeItem("loggedInUser");
    location.reload();
}

window.onload=function(){
    if(localStorage.getItem("loggedInUser")){
        showAppointment();
    }
}

</script>
</body>
</html>
